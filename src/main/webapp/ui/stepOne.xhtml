<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                template="../templates/templateWorkspace.xhtml">    

    <ui:define name="head"> 
    </ui:define>

    <ui:define name="cabecera">
        <ui:include src="cabecera.xhtml" />
        <p:staticMessage severity="warn" summary="#{msg['label.proxy.mode.client']}" detail="#{stepOneView.objUsuarioInfoProxy.strEmail}" rendered="#{stepOneView.objUsuarioInfoProxy!=null}" style="width: 100%; margin-top: 5px; margin-left: 2px; margin-right: 2px;"/>
        <p:staticMessage severity="info" summary="#{msg['info']}" detail="#{msg['project.info']} #{stepOneView.objProyectoInfo.strDescNombre}" style="width: 100%; margin-top: 5px; margin-left: 2px; margin-right: 2px;"/>
    </ui:define>

    <ui:define name="helpSteps">

        <h:form id="formPrincipalProyecto">

            <div class="p-field">
                <p:steps readonly="false" activeIndex="#{stepOneView.activeIndex}" >
                    <p:menuitem value="#{msg['step.1']}" actionListener="#{stepOneView.goToStep(1)}"/>
                    <p:menuitem value="#{msg['step.2']}" actionListener="#{stepOneView.goToStep(2)}"/>
                    <p:menuitem value="#{msg['step.3']}" actionListener="#{stepOneView.goToStep(3)}"/>
                    <p:menuitem value="#{msg['step.4']}" actionListener="#{stepOneView.goToStep(4)}"/>
                    <p:menuitem value="#{msg['step.5']}" actionListener="#{stepOneView.goToStep(5)}"/>
                    <p:menuitem value="#{msg['step.6']}" actionListener="#{stepOneView.goToStep(6)}"/>
                </p:steps></div>
            <p:spacer/>
            <div class="p-field">
                <center>
                    <p:commandButton value="#{msg['back']}" type="submit" actionListener="#{stepOneView.backStep()}" update="formPrincipalProyecto" styleClass="ui-button-secondary" disabled="true" icon="pi pi-angle-left" />
                    <p:spacer/>
                    <p:commandButton value="#{msg['next']}" type="submit" actionListener="#{stepOneView.nextStep()}" update="formPrincipalProyecto" styleClass="ui-button-secondary" icon="pi pi-angle-right" />                   
                </center>
            </div>

        </h:form>   

    </ui:define>

    <ui:define name="content">
        <p:panel>

            <p:card id="panel" >  
                <h:form id="frmGlobal">
                    <p:growl widgetVar="growlGlobal" life="4000" showSummary="true" />
                </h:form>
                <h3>#{msg['step1.title']}</h3>

                <div class="ui-fluid p-formgrid p-grid">

                    <div class="p-field p-col-12 p-md-12">
                        <p:outputLabel value="#{msg['Step1.description']}" />
                    </div>

                    <div class="p-field p-col-12 p-md-4">

                        <h:form id="frmSex">

                            <p:toggleSwitch id="switchSexo" value="#{parametrosView.blSexo}" disabled="#{evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}">
                                <p:ajax listener="#{parametrosView.activarParametro(82)}" resetValues="true" update="frmSex,formRed,frmGlobal" />
                            </p:toggleSwitch>     

                            <div class="p-field p-grid">
                                <div class="p-col">
                                    <p:outputLabel for="@next" value="#{msg['step1.sex.label']}" />
                                    <p:inputText id="strSex" type="text" value="#{parametrosView.strSex}" 
                                                 disabled="#{!parametrosView.blSexo or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" 
                                                 maxlength="500" required="true" >
                                        <f:validator validatorId="validarSex" />
                                    </p:inputText>
                                    <p:spacer/>
                                    <p:commandButton type="submit" icon="pi pi-save" value="#{msg['save']}" 
                                                     disabled="#{!parametrosView.blSexo or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}"
                                                     update="frmSex,frmGlobal,formRed" actionListener="#{parametrosView.guardarPreferencia(82)}" />
                                </div>
                            </div>
                        </h:form>
                    </div>

                    <div class="p-field p-col-12 p-md-4">
                        <h:form id="frmRango">

                            <p:toggleSwitch value="#{parametrosView.blRangoEdad}" disabled="#{evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" >
                                <p:ajax listener="#{parametrosView.activarParametro(83)}" resetValues="true" update="frmRango,frmGlobal,formRed" />
                            </p:toggleSwitch>

                            <div class="p-field p-grid">
                                <div class="p-col">
                                    <p:outputLabel for="@next" value="#{msg['step1.age.label']}" />
                                    <p:inputText id="strRangoEdad" type="text" value="#{parametrosView.strRangoEdad}" maxlength="500" 
                                                 disabled="#{!parametrosView.blRangoEdad or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" required="true" >
                                        <f:validator validatorId="validarRango" />                                       
                                    </p:inputText>
                                    <p:spacer/>
                                    <p:commandButton type="submit" icon="pi pi-save" value="#{msg['save']}"  
                                                     disabled="#{!parametrosView.blRangoEdad or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" 
                                                     update="frmRango,frmGlobal,formRed" actionListener="#{parametrosView.guardarPreferencia(83)}" />
                                </div>
                            </div>
                        </h:form>
                    </div>

                    <div class="p-field p-col-12 p-md-4">

                        <h:form id="frmTiempoEmpresa">

                            <p:toggleSwitch value="#{parametrosView.blTiempoEmpresa}" disabled="#{evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" >
                                <p:ajax listener="#{parametrosView.activarParametro(84)}" resetValues="true"  update="frmTiempoEmpresa,frmGlobal,formRed" />
                            </p:toggleSwitch>

                            <div class="p-field p-grid">
                                <div class="p-col">
                                    <p:outputLabel for="@next" value="#{msg['step1.hiring.time']}" />
                                    <p:inputText id="strRangoTiempo" value="#{parametrosView.strRangoTiempo}" maxlength="500" disabled="#{!parametrosView.blTiempoEmpresa or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" required="true" >
                                        <f:validator validatorId="validarRango" />
                                    </p:inputText>
                                    <p:spacer/>
                                    <p:commandButton type="submit" icon="pi pi-save" value="#{msg['save']}" 
                                                     disabled="#{!parametrosView.blTiempoEmpresa or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" 
                                                     update="frmTiempoEmpresa,frmGlobal,formRed" actionListener="#{parametrosView.guardarPreferencia(84)}" />

                                </div>
                            </div>
                        </h:form>
                    </div>

                    <div class="p-field p-col-12 p-md-4">
                        <h:form id="frmNivelOcupacional">

                            <p:toggleSwitch value="#{parametrosView.blNivelOcupacional}" disabled="#{evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" >
                                <p:ajax listener="#{parametrosView.activarParametro(85)}" resetValues="true"  update="frmNivelOcupacional,frmGlobal,formRed" />
                            </p:toggleSwitch>
                            <div class="p-field p-grid">
                                <div class="p-col">
                                    <p:outputLabel for="@next" value="#{msg['step1.lvlOcu.label']}" />
                                    <p:selectCheckboxMenu id="lstJob" value="#{parametrosView.selectedJob}" required="true"
                                                          label="#{msg['please.select']}" 
                                                          disabled="#{!parametrosView.blNivelOcupacional or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}">
                                        <f:selectItems value="#{parametrosView.job}" />
                                    </p:selectCheckboxMenu>
                                    <p:spacer/>
                                    <p:commandButton type="submit" icon="pi pi-save" value="#{msg['save']}" disabled="#{!parametrosView.blNivelOcupacional or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" 
                                                     update="frmNivelOcupacional,frmGlobal,formRed" actionListener="#{parametrosView.guardarPreferencia(85)}" />

                                </div>
                            </div>
                        </h:form>
                    </div>

                    <div class="p-field p-col-12 p-md-4">

                        <h:form id="frmAreaNegocio">

                            <p:toggleSwitch value="#{parametrosView.blAreaNegocio}" disabled="#{evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" >
                                <p:ajax listener="#{parametrosView.activarParametro(86)}" resetValues="true"  update="frmAreaNegocio,frmGlobal,formRed" />
                            </p:toggleSwitch>
                            <div class="p-field p-grid">
                                <div class="p-col">
                                    <p:outputLabel for="@next" value="#{msg['step1.area.label']}" />
                                    <p:selectCheckboxMenu id="lstAreaNegocioP" value="#{parametrosView.selectedAreaNegocio}" required="true"
                                                          label="#{msg['please.select']}"
                                                          disabled="#{!parametrosView.blAreaNegocio or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}">
                                        <f:selectItems value="#{parametrosView.area}" />
                                    </p:selectCheckboxMenu>
                                    <p:spacer/>
                                    <p:commandButton type="submit" icon="pi pi-save" value="#{msg['save']}" disabled="#{!parametrosView.blAreaNegocio or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0?true:false}" 
                                                     update="frmAreaNegocio,frmGlobal,formRed" actionListener="#{parametrosView.guardarPreferencia(86)}" />
                                </div>
                            </div>
                        </h:form>

                    </div>

                </div>


            </p:card>

            <p:spacer/>

            <h:form id="formRed" enctype="multipart/form-data" >

                <p:growl widgetVar="growl" id="growl" life="4000" showSummary="true" />

                <p:card id="panel">  

                    <h3>#{msg['step1.title2']}</h3>

                    <div class="ui-fluid p-formgrid p-grid">

                        <div class="p-field p-col-12 p-md-12">
                            <p:outputLabel value="#{msg['step1.decription2']}" />
                        </div>
                    </div>
                    <div class="ui-fluid p-formgrid p-grid">
                        <div class="p-field p-col-12 p-md-6">
                            <p:card>
                                <f:facet name="title">
                                    #{msg['step1.upload.configuration']}
                                </f:facet>
                                <div class="p-field">

                                    <p:fileUpload widgetVar="archivoMasivoEvaluado" 
                                                  mode="advanced"
                                                  fileLimit="1" 
                                                  update="formRed,frmSex,frmRango,frmTiempoEmpresa,frmNivelOcupacional,frmAreaNegocio"
                                                  sizeLimit="4000000" 
                                                  invalidSizeMessage="#{msg['max.file.upload.error']}"
                                                  validateContentType="true"
                                                  allowTypes="/(\.|\/)(xlsx)$/"
                                                  label="#{msg['search']}" 
                                                  uploadLabel="#{msg['upload']}" global="false"
                                                  cancelLabel="#{msg['cancel']}"
                                                  listener="#{evaluadosView.leeExcelAvanzado}"
                                                  disabled="#{evaluadosView.lstRelacionBean.size()>0 or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0}" 
                                                  />
                                </div>
                                <!--
                                <div class="p-field">
                                    <p:commandButton id="btnUploadFile" value="#{msg['upload']}" ajax="true" 
                                                     actionListener="#{evaluadosView.leeExcelAvanzado}" 
                                                     disabled="#{evaluadosView.lstRelacionBean.size()>0 or evaluadosView.lstEvaluado.size()>0 or evaluadosView.lstEvaluadores.size()>0}"
                                                     icon="pi pi-upload" update="formRed,frmSex,frmRango,frmTiempoEmpresa,frmNivelOcupacional,frmAreaNegocio" />
                                </div>
                                -->
                            </p:card>
                        </div>
                        <div class="p-field p-col-12 p-md-6">
                            <p:card>
                                <f:facet name="title">
                                    #{msg['step1.material.label']}
                                </f:facet>
                                <div class="p-field">
                                    <p:commandButton value="#{msg['step1.download.format']}" actionListener="#{evaluadosView.generaModeloAzanvado()}" immediate="true" ajax="false" icon="pi pi-download" styleClass="ui-button-warning" >
                                        <p:fileDownload value="#{evaluadosView.xlsContentAvanzado}" />
                                    </p:commandButton>
                                </div>
                                <!--div class="p-field">
                                    <p:commandButton value="#{msg['step1.download.guide']}" actionListener="#{evaluadosView.generaModeloAzanvado()}" disabled="true" immediate="true" ajax="false" icon="pi pi-download" styleClass="ui-button-warning"  >
                                        <p:fileDownload value="#{evaluadosView.xlsContentAvanzado}" />
                                    </p:commandButton>
                                </div-->
                            </p:card>
                        </div>

                        <c:if test="#{evaluadosView.lstErrorAvan.size()>0}">
                            <div class="p-field p-col-12 p-md-12">
                                <p:card rendered="#{evaluadosView.lstErrorAvan.size()>0}">
                                    <p:staticMessage severity="error" summary="ERROR" 
                                                     detail="#{msg['step1.detail.label']}" 
                                                     style="width: 100%"/>
                                    <p:spacer/>
                                    <h:panelGrid columns="4">
                                        <p:commandButton value="#{msg['export.xls']}" styleClass="mr-2 mb-2">
                                            <p:dataExporter type="xls" target="tblErrorAvan" fileName="#{msg['name.file.error.list.downloaded']}"/>
                                        </p:commandButton>

                                        <p:commandButton value="#{msg['export.xlsx']}" styleClass="mr-2 mb-2">
                                            <p:dataExporter type="xlsxstream" target="tblErrorAvan" fileName="#{msg['name.file.error.list.downloaded']}"/>
                                        </p:commandButton>

                                        <p:commandButton value="#{msg['export.csv']}" styleClass="mr-2 mb-2">
                                            <p:dataExporter type="csv" target="tblErrorAvan" fileName="#{msg['name.file.error.list.downloaded']}" />
                                        </p:commandButton>

                                        <p:commandButton value="#{msg['export.xml']}" styleClass="mr-2 mb-2">
                                            <p:dataExporter type="xml" target="tblErrorAvan" fileName="#{msg['name.file.error.list.downloaded']}"/>
                                        </p:commandButton>

                                    </h:panelGrid>

                                    <p:dataTable 
                                        id="tblErrorAvan"
                                        widgetVar="tblErrorAvan"
                                        rows="10"
                                        paginator="true" 
                                        var="err"
                                        stripedRows="true"
                                        value="#{evaluadosView.lstErrorAvan}"
                                        rowsPerPageTemplate="5,10,30,{ShowAll|'All'}"
                                        paginatorPosition="bottom"
                                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                        currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords}"
                                        emptyMessage="#{msg['no.items']}"
                                        rowIndexVar="index"
                                        rendered="#{evaluadosView.lstErrorAvan.size()>0}">

                                        <f:facet name="header">
                                            #{msg['step1.list.errors']}
                                        </f:facet>  

                                        <f:facet name="footer">
                                            #{msg['step1.errores.encontrados']} #{evaluadosView.lstErrorAvan.size()}
                                        </f:facet>

                                        <p:column style="width: 20px;" headerText="#" exportHeaderValue="#{msg['number']}" >
                                            <h:outputText 
                                                value="#{index + 1}" />
                                        </p:column> 
                                        <p:column headerText="#{msg['description']}">
                                            <h:outputText value="#{err.strDesc}" />
                                        </p:column>                      
                                        <p:column headerText="#{msg['status']}" exportable="false">
                                            <p:tag value="#{msg['step1.please.resolve']}" severity="danger" />
                                        </p:column>

                                    </p:dataTable>

                                </p:card>
                            </div>
                        </c:if>

                        <c:if test="#{evaluadosView.lstAvanPersonas.size()>0 and evaluadosView.lstRelacionAvanzadas.size()>0}">
                            <div class="p-field p-col-12 p-md-12">
                                <p:card rendered="#{evaluadosView.lstAvanPersonas.size()>0}" >
                                    <p:dataTable 
                                        id="tblResultadoAvanzadoPersonas"
                                        widgetVar="tblResultadoAvanzadoPersonas"
                                        rows="10"
                                        paginator="true" 
                                        var="reg"
                                        resizableColumns="true"
                                        value="#{evaluadosView.lstAvanPersonas}"
                                        rowsPerPageTemplate="5,10,30,{ShowAll|'All'}"
                                        paginatorPosition="bottom"
                                        stripedRows="true"
                                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                        currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords}"
                                        emptyMessage="#{msg['no.items']}" 
                                        rowIndexVar="index" 
                                        rendered="#{evaluadosView.lstAvanPersonas.size()>0}" >

                                        <f:facet name="header">
                                            #{msg['step1.list.items.found']}

                                        </f:facet>

                                        <f:facet name="footer">
                                            #{msg['step1.total.items.found']} #{evaluadosView.lstAvanPersonas.size()}
                                        </f:facet>

                                        <p:column style="width: 20px;">
                                            <f:facet name="header" >
                                                <h:outputText value="#" />
                                            </f:facet>
                                            <h:outputText 
                                                value="#{index + 1}" />
                                        </p:column>

                                        <p:column headerText="#{msg['photo']}">
                                            <p:graphicImage url="#{reg.paTxImgUrl}" height="75" width="75" class="classimg" rendered="#{reg.paTxImgUrl!=null}" />
                                            <p:graphicImage value="/images/no-picture.png" height="75" width="75"  class="classimg" rendered="#{reg.paTxImgUrl==null}" />
                                        </p:column>
                                        <p:column headerText="#{msg['description']}">
                                            <h:outputText value="#{reg.paTxDescripcion}" />
                                        </p:column>
                                        <p:column headerText="#{msg['role']}">
                                            <h:outputText value="#{reg.paTxNombreCargo}" />
                                        </p:column>                                 
                                        <p:column headerText="#{msg['email']}">
                                            <h:outputText value="#{reg.paTxCorreo}" />
                                        </p:column>
                                        <p:column headerText="#{msg['sex']}" rendered="#{evaluadosView.blHabilitarSexo}">
                                            <h:outputText value="#{reg.paTxSexo}" />
                                        </p:column>
                                        <p:column headerText="#{msg['age']}" rendered="#{evaluadosView.blHabilitarEdad}">
                                            <h:outputText value="#{reg.paNrEdad}" />
                                        </p:column>
                                        <p:column headerText="#{msg['hiring.time']}" rendered="#{evaluadosView.blHabilitarTiempoEmpresa}">
                                            <h:outputText value="#{reg.paNrTiempoTrabajo}" />
                                        </p:column>
                                        <p:column headerText="#{msg['work.range']}" rendered="#{evaluadosView.blHabilitarNivelOcupacional}">
                                            <h:outputText value="#{reg.paTxOcupacion}" />
                                        </p:column>
                                        <p:column headerText="#{msg['working.area']}" rendered="#{evaluadosView.blHabilitarAreaNegocio}">
                                            <h:outputText value="#{reg.paTxAreaNegocio}" />
                                        </p:column>
                                        <p:column style="text-align: center;" headerText="#{msg['autoevaluate']}">
                                            <p:selectBooleanCheckbox value="#{reg.paInAutoevaluar}" disabled="true" />
                                        </p:column>

                                    </p:dataTable>
                                </p:card>
                            </div>
                        </c:if>
                        <c:if test="#{evaluadosView.lstAvanRelacion.size()>0 and evaluadosView.lstRelacionAvanzadas.size()>0}">
                            <div class="p-field p-col-12 p-md-5">
                                <p:card id="cardTblResultado">
                                    <p:dataTable 
                                        id="tblResultadoAvanzadoRelacion"
                                        widgetVar="tblResultadoAvanzadoRelacion"
                                        rows="10"
                                        paginator="true" 
                                        var="rel"
                                        value="#{evaluadosView.lstAvanRelacion}"
                                        paginatorPosition="bottom"
                                        rowsPerPageTemplate="5,10,30,{ShowAll|'All'}"
                                        resizableColumns="true"
                                        editable="true"
                                        editMode="cell"
                                        editInitEvent="dblclick" 
                                        stripedRows="true"
                                        sortMode="single"
                                        rowIndexVar="index"
                                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                        currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords}"
                                        emptyMessage="#{msg['no.items']}"
                                        rendered="#{evaluadosView.lstAvanRelacion.size()>0}"
                                        >

                                        <p:ajax event="cellEdit" listener="#{evaluadosView.actualizarRelacionTemporal}" update="formRed:tblRelacionAvanzadas,formRed:growl"/>

                                        <f:facet name="header">
                                            #{msg['step1.list.relationships']}
                                        </f:facet>

                                        <f:facet name="footer">
                                            #{msg['step1.total.relationships']} #{evaluadosView.lstAvanRelacion.size()}
                                        </f:facet>
                                        <p:column style="width: 20px;">
                                            <f:facet name="header">
                                                <h:outputText value="#" />
                                            </f:facet>
                                            <h:outputText 
                                                value="#{index + 1}" />
                                        </p:column> 
                                        <p:column headerText="#{msg['relationship']}" sortBy="#{rel.strNombre}" sortOrder="asc" >
                                            <h:outputText value="#{rel.strNombre}" />
                                        </p:column>
                                        <p:column headerText="#{msg['abbreviation']}">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{rel.strAbreviatura}"  />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputText value="#{rel.strAbreviatura}" maxlength="3" style="width: 100%;" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>
                                        <p:column style="text-align: center" headerText="#{msg['assigned.color']}" >
                                            <p:tag value="##{rel.strColor}" style=" width: 80px; height: 17px; background-color: ##{rel.strColor};" />
                                        </p:column>

                                        <p:column style="text-align: center"  >
                                            <p:colorPicker value="#{rel.strColor}"   >
                                                <p:ajax listener="#{evaluadosView.actualizaColorTemporal(rel)}" process="@this" update="@form"/>
                                            </p:colorPicker>
                                        </p:column>

                                    </p:dataTable>

                                </p:card>
                            </div>
                        </c:if>
                        <c:if test="#{evaluadosView.lstRelacionAvanzadas.size()>0}">
                            <div class="p-field p-col-12 p-md-7">
                                <p:card >
                                    <p:dataTable 
                                        id="tblRelacionAvanzadas"
                                        widgetVar="tblRelacionAvanzadas"
                                        rows="10"
                                        rowsPerPageTemplate="5,10,30,{ShowAll|'All'}"
                                        paginator="true" 
                                        var="red"
                                        value="#{evaluadosView.lstRelacionAvanzadas}"
                                        paginatorPosition="bottom"
                                        resizableColumns="true"
                                        stripedRows="true"
                                        sortMode="single"
                                        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                        emptyMessage="#{msg['no.items']}" 
                                        rendered="#{evaluadosView.lstRelacionAvanzadas.size()>0}" >

                                        <f:facet name="header">
                                            #{msg['step1.list.network.found']}
                                        </f:facet>

                                        <f:facet name="footer">
                                            #{msg['step1.total.network.found']} #{evaluadosView.lstRelacionAvanzadas.size()}
                                        </f:facet>

                                        <p:column headerText="#{msg['evaluated']}" sortBy="#{red.strEvaluado}" groupRow="true" sortOrder="asc" sortPriority="1" >
                                            <h:outputText value="#{red.strEvaluadoDesc}" />
                                            <br/>
                                            <h:outputText value="#{red.strEvaluado}" class="p-text-light" />
                                        </p:column>
                                        <p:column headerText="#{msg['relationship']}" sortBy="#{red.strRelacionAbreviatura}" sortOrder="asc" sortPriority="2" >
                                            <p:tag value="#{red.strRelacionAbreviatura}" style=" width: 80px; height: 17px; background-color: ##{red.strRelacionColor};" />
                                        </p:column>                                 
                                        <p:column headerText="#{msg['evaluator']}" sortBy="#{red.strEvaluador}" sortOrder="asc" sortPriority="3" >
                                            <h:outputText value="#{red.strEvaluadorDesc}" />
                                            <br/>
                                            <h:outputText value="#{red.strEvaluador}" class="p-text-light" />
                                        </p:column>

                                    </p:dataTable>
                                </p:card>

                            </div>
                        </c:if>

                        <c:if test="#{evaluadosView.lstEvaluado.size()>0}">
                            <div class="p-field p-col-12 p-md-12">
                                <h4>#{msg['step1.list.evaluated.found']}</h4>
                                <p:card>
                                    <div class="p-field">
                                        <p:dataTable 
                                            id="lstEvaluados"
                                            var="reg"
                                            widgetVar="lstEvaluados"
                                            resizableColumns="true"
                                            value="#{evaluadosView.lstEvaluado}" 
                                            rows="10"
                                            rowsPerPageTemplate="5,10,{ShowAll|'All'}"
                                            paginatorPosition="bottom"
                                            stripedRows="true"
                                            paginator="true" 
                                            size="small"
                                            paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                            emptyMessage="#{msg['no.items']}"
                                            rowIndexVar="index"
                                            >

                                            <p:column style="width: 20px;">
                                                <f:facet name="header">
                                                    <h:outputText value="#" />
                                                </f:facet>
                                                <h:outputText 
                                                    value="#{index + 1}" />
                                            </p:column> 
                                            <p:column headerText="#{msg['photo']}"> 
                                                <p:graphicImage url="#{reg.paTxImgUrl}" height="75" width="75" class="classimg" rendered="#{reg.paTxImgUrl!=null}" />
                                                <p:graphicImage value="/images/no-picture.png" height="75" width="75"  class="classimg" rendered="#{reg.paTxImgUrl==null}" />
                                            </p:column>
                                            <p:column headerText="#{msg['description']}" sortBy="#{reg.paTxDescripcion}">
                                                <h:outputText value="#{reg.paTxDescripcion}" />
                                            </p:column>                           
                                            <p:column headerText="#{msg['email']}" sortBy="#{reg.paTxCorreo}">
                                                <h:outputText value="#{reg.paTxCorreo}" />
                                            </p:column>    
                                            <p:column headerText="#{msg['sex']}" sortBy="#{reg.paTxSexo}" rendered="#{evaluadosView.blHabilitarSexo}" >
                                                <h:outputText value="#{reg.paTxSexo}" />
                                            </p:column>    
                                            <p:column headerText="#{msg['age']}" sortBy="#{reg.paNrEdad}" rendered="#{evaluadosView.blHabilitarEdad}"  >
                                                <h:outputText value="#{reg.paNrEdad}"  />
                                            </p:column>   
                                            <p:column headerText="#{msg['hiring.time']}" sortBy="#{reg.paNrTiempoTrabajo}" rendered="#{evaluadosView.blHabilitarTiempoEmpresa}" >
                                                <h:outputText value="#{reg.paNrTiempoTrabajo}" />
                                            </p:column>    
                                            <p:column headerText="#{msg['work.range']}" sortBy="#{reg.paTxOcupacion}" rendered="#{evaluadosView.blHabilitarNivelOcupacional}">
                                                <h:outputText value="#{reg.paTxOcupacion}" />
                                            </p:column>  
                                            <p:column headerText="#{msg['working.area']}" sortBy="#{reg.paTxAreaNegocio}" rendered="#{evaluadosView.blHabilitarAreaNegocio}" >
                                                <h:outputText value="#{reg.paTxAreaNegocio}" />
                                            </p:column>  
                                            <p:column headerText="#{msg['autoevaluate']}">
                                                <p:selectBooleanCheckbox value="#{reg.paInAutoevaluar}" disabled="true" />
                                            </p:column>

                                        </p:dataTable>

                                    </div>

                                </p:card>

                            </div>
                        </c:if>


                        <c:if test="#{evaluadosView.lstRelacionBean.size()>0}">

                            <div class="p-field p-col-12 p-md-5">
                                <p:card id="cardAverageRelationship">
                                    <h3>#{msg['available.average.relationships']}</h3>
                                    <p:toggleSwitch  id="switchPonderado" value="#{parametrosView.blPonderacionHabilitado}">
                                        <p:ajax listener="#{parametrosView.activarParametro(87)}" resetValues="true" update="tblResultadoRelacion, cardAverageRelationship" />
                                    </p:toggleSwitch>   
                                    <p:staticMessage severity="#{evaluadosView.blTotalPonderado.doubleValue()==100.00?'info':'error'}" 
                                                     detail="#{evaluadosView.blTotalPonderado.doubleValue()==100?msg['average.relationships.total.ok']:msg['average.relationships.total.error']} #{evaluadosView.blTotalPonderado.doubleValue()}%" style="width: 100%; margin-top: 5px; margin-left: 2px; margin-right: 2px;"
                                                     rendered="#{parametrosView.blPonderacionHabilitado}"/>
                                </p:card>
                                <p:divider/>
                                <p:card>

                                    <p:dataTable 
                                        id="tblResultadoRelacion"
                                        widgetVar="tblResultadoRelacion"
                                        rows="10"
                                        paginator="true" 
                                        var="rel"
                                        value="#{evaluadosView.lstRelacionBean}"
                                        paginatorPosition="bottom"
                                        editable="true"
                                        editMode="cell"
                                        editInitEvent="dblclick" 
                                        stripedRows="true"
                                        resizableColumns="true"
                                        sortMode="single"
                                        rowIndexVar="index"
                                        rowsPerPageTemplate="5,10,30,{ShowAll|'All'}"
                                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                        currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords}"
                                        emptyMessage="#{msg['no.items']}"
                                        rendered="#{evaluadosView.lstRelacionBean.size()>0}"
                                        >

                                        <p:ajax event="cellEdit" listener="#{evaluadosView.actualizarRelacionDefinitivo}" update="formRed:tblRelacionesEvaluadoEvaluador,formRed:growl"/>

                                        <f:facet name="header">
                                            #{msg['step1.list.relationships']}
                                        </f:facet>

                                        <f:facet name="footer">
                                            #{msg['step1.total.relationships']} #{evaluadosView.lstRelacionBean.size()}
                                        </f:facet>
                                        <p:column style="width: 20px;">
                                            <f:facet name="header">
                                                <h:outputText value="#" />
                                            </f:facet>
                                            <h:outputText 
                                                value="#{index + 1}" />
                                        </p:column> 
                                        <p:column headerText="#{msg['relationship']}" sortBy="#{rel.strNombre}" sortOrder="asc" >
                                            <h:outputText value="#{rel.strNombre}" />
                                        </p:column>
                                        <p:column headerText="#{msg['abbreviation']}">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{rel.strAbreviatura}"  />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputText value="#{rel.strAbreviatura}" maxlength="3" style="width: 100%;" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>
                                        <p:column style="text-align: center" headerText="#{msg['assigned.color']}" >
                                            <p:tag value="#{rel.strColor}" style=" width: 80px; height: 17px; background-color: ##{rel.strColor};" />
                                        </p:column>
                                        <p:column style="text-align: center"  >
                                            <p:colorPicker value="#{rel.strColor}"   >
                                                <p:ajax listener="#{evaluadosView.actualizaColorDefinitivo(rel)}" process="@this" update="@form"/>
                                            </p:colorPicker>
                                        </p:column>
                                        <p:column style="text-align: center" headerText="#{msg['signo.porcentaje']}" rendered="#{parametrosView.blPonderacionHabilitado}">
                                            <p:inputNumber value="#{rel.dbPonderado}" minValue="0" maxValue="100" decimalPlaces="2"  symbol="%"
                                                           symbolPosition="s" emptyValue="zero" >
                                                <p:ajax event="blur" update="formRed:cardAverageRelationship, formRed:growl" listener="#{evaluadosView.actualizaPonderado(rel)}" />
                                            </p:inputNumber>

                                        </p:column>

                                    </p:dataTable>

                                </p:card>
                            </div>
                        </c:if>

                        <c:if test="#{evaluadosView.lstRelacionesEvaluadoEvaluador.size()>0}">
                            <div class="p-field p-col-12 p-md-7">
                                <p:card >
                                    <p:dataTable 
                                        id="tblRelacionesEvaluadoEvaluador"
                                        widgetVar="tblRelacionesEvaluadoEvaluador"
                                        rows="10"
                                        paginator="true" 
                                        var="red"
                                        value="#{evaluadosView.lstRelacionesEvaluadoEvaluador}"
                                        paginatorPosition="bottom"
                                        stripedRows="true"
                                        rowsPerPageTemplate="5,10,30,{ShowAll|'All'}"
                                        resizableColumns="true"
                                        sortMode="single"
                                        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                        emptyMessage="#{msg['no.items']}" 
                                        rendered="#{evaluadosView.lstRelacionesEvaluadoEvaluador.size()>0}" >

                                        <f:facet name="header">
                                            #{msg['step1.list.network.found']}
                                        </f:facet>

                                        <f:facet name="footer">
                                            #{msg['step1.total.network.found']} #{evaluadosView.lstRelacionesEvaluadoEvaluador.size()}
                                        </f:facet>

                                        <p:column headerText="#{msg['evaluated']}" sortBy="#{red.strEvaluado}" groupRow="true" sortOrder="asc" sortPriority="1" >
                                            <h:outputText value="#{red.strEvaluadoDesc}" />
                                            <br/>
                                            <h:outputText value="#{red.strEvaluado}" class="p-text-light" />
                                        </p:column>
                                        <p:column headerText="#{msg['relationship']}" sortBy="#{red.strRelacionAbreviatura}" sortOrder="asc" sortPriority="2" >
                                            <p:tag value="#{red.strRelacionAbreviatura}" style=" width: 80px; height: 17px; background-color: ##{red.strRelacionColor};" />
                                        </p:column>                                 
                                        <p:column headerText="#{msg['evaluator']}" sortBy="#{red.strEvaluador}" sortOrder="asc" sortPriority="3" >
                                            <h:outputText value="#{red.strEvaluadorDesc}" />
                                            <br/>
                                            <h:outputText value="#{red.strEvaluador}" class="p-text-light" />
                                        </p:column>

                                    </p:dataTable>
                                </p:card>

                            </div>
                        </c:if>

                        <c:if test="#{evaluadosView.blCargarCorrectoAvan and evaluadosView.lstErrorAvan.size()==0}">
                            <p:commandButton value="#{msg['step1.save.participant.networks']}" 
                                             rendered="#{evaluadosView.blCargarCorrectoAvan}" 
                                             disabled="#{!evaluadosView.blCargarCorrectoAvan}" 
                                             actionListener="#{evaluadosView.cargarListaAvanzado()}"
                                             type="submit"
                                             style="width: 100%;" 
                                             update="formRed,frmSex,frmRango,frmTiempoEmpresa,frmNivelOcupacional,frmAreaNegocio"
                                             icon="pi pi-save" /> 

                        </c:if>

                        <c:if test="#{evaluadosView.lstEvaluado.size()>0 and evaluadosView.lstEvaluadores.size()>0}">
                            <p:commandButton value="#{msg['step1.delete.participant.networks']}" 
                                             rendered="#{(evaluadosView.lstEvaluado.size()>0 and evaluadosView.lstEvaluadores.size()>0 
                                                         and
                                                         !(evaluadosView.intIdEstadoProyecto == 37 or evaluadosView.intIdEstadoProyecto == 34))}" 
                                             styleClass="ui-button-danger"
                                             actionListener="#{evaluadosView.eliminarCargar()}"
                                             type="submit"
                                             update="formRed,frmSex,frmRango,frmTiempoEmpresa,frmNivelOcupacional,frmAreaNegocio"
                                             icon="pi pi-times">
                                <p:confirm header="#{msg['confirmation']}" message="#{msg['are.you.sure.delete.configuration']}" icon="pi pi-info-circle" />
                            </p:commandButton>

                        </c:if>

                    </div>

                </p:card>

            </h:form>

        </p:panel>
    </ui:define>
</ui:composition>